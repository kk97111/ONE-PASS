# ONE-PASS
---
This repository contains the source code for **ONE-PASS: Single Forward Pass Decoding for Listwise Reranking**, which is subbimted for peer review. The overall architecture is shown as follows:

<img src="./intro.pdf" width="45%"/> <img src="./pdf" width="45%"/>

 
---

## Quick Start （Finally Step）
To run the **ONE-PASS** model with different hyper-parameters, use run run_RPO.sh in python. run `bash run_RPO.sh`.
### Requirement:
```python
transformers==4.50.0
torch==2.5.1
```

## Workflow
The following steps outline the process for data_prepare, training and evaluate ONE-PASS:

### Step 1: Data preprocessing
Get the auto-regressive ranking generated by the target LLM for fast training and evaluation:

- `./dataset/dataset_processing_Llama.ipynb`  (Already included in this repository, you can skip it)

### Step 2: Training and evaluation 
-  run `bash run.sh` with different settings.
-  See result in './log/$dataset/$backbone/$model_name', including log and model_save
 

## Ablation studies.
You can select dataset = ("rank_zephyr_IR_20" "quora_25" "ml-1m_25" "Games_25")  with variant as follows:
- --variant 'Permutation' 
- --variant 'Naive_add' 
- --variant 'wo_HAS'
- --variant ''wo_Mobius-1' 
- --variant ''wo_Mobius-2' 
- --variant ''ONE-PASS'
---
