# ONE-PASS
---
This repository contains the source code for **ONE-PASS: Single Forward Pass Decoding for Listwise Reranking**, which is subbimted for peer review. The overall architecture is shown as follows:

![m](./main.png)

 
---

## Quick Start （Finally Step）
To run the **ONE-PASS** model with different hyper-parameters, use run run_RPO.sh in python. run `bash run_RPO.sh`.
### Requirement:
```python
transformers==4.50.0
torch==2.5.1
```

## Workflow
The following steps outline the process for data_prepare, training and evaluate ONE-PASS:

### Step 1: Data preprocessing
Get the auto-regressive ranking generated by the target LLM for fast training and evaluation:

- `./dataset/dataset_processing_Llama.ipynb`  (Already included in this repository, you can skip it)

### Step 2: 
-  run `bash run.sh`.
-  See result in './log/$dataset/$backbone/$model_name', including log and model_save
 

## Ablation studies.
- **STD** (Single Token Decoding): `STD.ipynb`
- **GSD** (Greedy Speculative Decoding): `GSD.ipynb`
- **w/o RPO** Removing the RPO: `wo RPO.ipynb`
- **w/o LRK** : Removing Listwise Ranking Knowledge: `wo LRK.ipynb`
- **w/o RA** (Reference Advantage): `bash run_SI.sh` by setting `--reward Group`


---
